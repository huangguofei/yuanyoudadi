var common={path:"",goodsState:0,narSwiper:null,init:function(){var e=this,t=window.location.host,n=window.location.href;t.indexOf("yuanyoudadi.com")>=0&&(window.location.href=n.replace("yuanyoudadi.com","naturalgiving.cn")),document.addEventListener("touchstart",function(e){e.touches.length>1&&e.preventDefault()});var i=0;document.addEventListener("touchend",function(e){var t=(new Date).getTime();t-i<=300&&e.preventDefault(),i=t},!1);var a=document.documentElement,o="orientationchange"in window?"orientationchange":"resize",r=function(){window.location.href.indexOf("/comment/")<=0&&e.detectmob(a.clientWidth);var t=a.clientWidth/640*32;t>19&&(t=18.75),a.style.fontSize=t+"px"};r(),setTimeout(function(){e.headerNarFade(),window.addEventListener(o,r,!1),document.addEventListener("DOMContentLoaded",r,!1);var t=window.location.href;document.querySelector(".scroll")&&0==t.indexOf("/quiz")&&e.overscroll(document.querySelector(".scroll"))},200)},detectmob:function(e){if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)){if(navigator.userAgent.match(/Android/i)&&e>768){t=window.location.href;window.location.href=t.replace("wap","web")}return!0}var t=window.location.href;return window.location.href=t.replace("wap","web"),!1},overscroll:function(e){e.addEventListener("touchstart",function(){var t=e.scrollTop,n=e.scrollHeight,i=t+e.offsetHeight;0===t?e.scrollTop=1:i===n&&(e.scrollTop=t-1)}),e.addEventListener("touchmove",function(t){e.offsetHeight<=e.scrollHeight&&(t._isScroller=!0)}),document.body.addEventListener("touchmove",function(e){e._isScroller||e.preventDefault()})},commonEvent:function(){$(".swiper-container").find(".colse-footer").click(function(){var e=$(".footer-fixed");e.animate({bottom:-e.height()},500,function(){e.addClass("footer-hide")})})},headerNarFade:function(){var e=this;$(".swiper-container-nar").length>0&&(this.narSwiper=new Swiper(".swiper-container-nar",{paginationClickable:!1,mode:"vertical",speed:600,moveStartThreshold:80,resistance:"100%"}));var t=$("#narList").hide();$("#wapNar").click(function(){$(this);t.show().animate({right:0},300)}),t.find(".close").click(function(){t.animate({right:"-100%"},300,function(){t.hide()})}),t.find(".more-nar").click(function(){e.narSwiper.swipeNext()}),t.find(".close-top").click(function(){e.narSwiper.swipePrev()}),$("#upComing").find(".close").click(function(){$("#upComing").animate({right:"-100%"},300,function(){$(this).hide()})}),this.commonEvent()},narActive:function(e){var t=$("#headNar").find(".nar").find("."+e);t&&t.addClass("active")},leftNarLayer:function(){var e=$("#leftNar");e.animate({left:"0"},500,function(){e.find(".bg-layer").show(),e.css("overflow-y","auto")})},closeLeftNar:function(){$("#leftNar").css("overflow-y","hidden").animate({left:"-100%"},500)},openUpComing:function(){$("#upComing").show().animate({right:0},300)},commAjax:function(e){if(e){var t="";e.url&&(t=this.path+"/yydd-web/"+e.url),$.ajax({url:t,type:e.type?e.type:"POST",cache:!1,data:e.data?e.data:null,async:!1!==e.async,dataType:e.dataType?e.dataType:"json",beforeSend:function(e){return!0},success:e.success?function(t){var n=t.data;200==t.code?e.success(n):alert(t.msg)}:function(e){},error:e.error?e.error:function(e,t,n){alert("服务器异常，请稍候再试")}})}},getParamsString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null},narActive:function(e){var t=$("#narList").find(".nar").find("."+e);t&&t.addClass("active")},errorMessage:function(e,t){var n=$('<div class="error-mes"><span>'+e+"</span></div>");t.append(n),n.fadeIn(function(){n.delay(1e3).fadeOut(function(){n.remove()})})}};common.init();var chooseModule={mySwiper:null,init:function(){$("#chooseSwiper").find(".swiper-slide").length;this.mySwiper=new Swiper(".swiper-container",{paginationClickable:!1,mode:"vertical",speed:600,resistance:"100%",onSlideChangeEnd:function(e){}}),$("#chooseSwiper").find(".swiper-wrapper").show(),this.pageEvent()},pageEvent:function(){var e=$("#chooseSwiper"),t=this,n=e.find(".cor-list");n.find(".c-item").click(function(){n.find(".c-item").removeClass("active"),$(this).addClass("active")});var i=e.find(".select-cor");i.find(".next").click(function(){var e=i.find(".cor-list .active"),t=$(".isSubmit"),n=$(this);if(!t.is(":hidden"))return!1;if(e.length){var a=e.attr("key");window.location.href="/wap/view/choose/result.html?type="+a}else n.find(".info").fadeIn(2e3,function(){n.find(".info").fadeOut(2e3)})}),e.find(".slide-1 .btn-event").click(function(){t.mySwiper.swipeNext()})},zhRepeatNum:function(e){return{1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"七",8:"八",9:"九",10:"十"}[++e]},nextPgae:function(){alert(123)}},quizModule={init:function(){var e=common.getParamsString("type");e?this.submitChoose(1,e):$("#subjectWrap").show(),this.pageEvent()},pageEvent:function(){var e=this,t=$("#subjectWrap");t.find(".a-item").click(function(){var e=$(this),t=e.parent();if(t.hasClass("enabled")){t.find(".a-item").removeClass("active"),e.addClass("active");var n=t.parent().next();if(n){if(n.find(".answer").addClass("enabled"),n.hasClass("row-active"))return!1;t.parent().addClass("row-active").removeClass("row-select"),n.addClass("row-select")}}}),t.find(".next").click(function(){var e=t.find(".sub-active");if(e.hasClass("cons-issue")){var n=e.find(".active").length,i=e.find(".issue").length,a=$(this);n<i?a.find(".info").fadeIn(2e3,function(){a.find(".info").fadeOut(2e3)}):(e.removeClass("sub-active"),(o=e.next()).index()>0?(e.next().addClass("sub-active"),t.find(".prev").show(),t.find(".confim").hide()):t.find(".prev").hide())}else{var o=e.removeClass("sub-active").next().addClass("sub-active"),r=t.find(".cons-item").length;o.index()==r-1&&(t.find(".next").hide(),t.find(".confim").show()),o.index()>0&&t.find(".prev").show()}}),t.find(".prev").click(function(){var e=t.find(".sub-active"),n=(e.find(".active").length,t.find(".sub-item").length),i=$(this);e.removeClass("sub-active");var a=e.prev().addClass("sub-active").index();0==a?i.hide():a<n-1&&(t.find(".next").show(),t.find(".confim").hide())}),t.find(".confim").click(function(){$(".isSubmit");var n=$(this),i=t.find(".sub-active");if(i.find(".active").length<i.find(".issue").length)n.find(".info").fadeIn(2e3,function(){n.find(".info").fadeOut(2e3)});else{var a=[];t.find(".cons-issue").each(function(e){var t=$(this),n=t.attr("key"),i=t.attr("val"),o=t.find(".issue").length,r=a[e]={grade:[],sub:0,type:n,name:i},s=0;t.find(".issue").each(function(e){var t=$(this).find(".active").attr("key");r.grade[e]=t,s+=Number(t)}),r.sub=100*[(s-o)/(4*o)]}),e.submitChoose(a)}})},detectionConstitution:function(e){var t=0,n=0,i=-1,a="",o=0,r=-1,s=0;$.each(e,function(e,a){var s=a.sub;0==e?t=s:(s>=40&&(++n,i=e),o<s&&(o=s,r=e))}),t>=60&&0==n?(a=e[0].name,s=1):n>0&&o>=e[i].sub?(a=e[r].name,s=e[r].type):n>0&&o<e[i].sub?(a=e[i].name,s=e[i].type):0==n&&o>30?(a=e[r].name,s=e[r].type):(a=e[0].name,s=1);var c={type:s,grades:e};return{name:a,type:s,grades:JSON.stringify(c)}},submitChoose:function(e){var t=this,n=$(".isSubmit");n.show();var i={testRecord:t.detectionConstitution(e).grades};common.commAjax({type:"POST",url:"constitution/addConstitutionTestRecord",data:i,success:function(e){n.hide(),window.location.href="/wap/view/choose/result.html?id="+e}})}},resultModule={init:function(){var e=this,t=common.getParamsString("type"),n=common.getParamsString("id"),i=$(".result-wrap");if(setTimeout(function(){i.show()},100),t){var a=this.returnConsStr(t),o=this.returnConsReamk(t);i.find(".reamk").empty().append(o),i.find(".name").text(a)}else n?common.commAjax({type:"POST",url:"constitution/getConstitutionTestRecord",data:{constitutionTestRecordId:n},success:function(a){var o=JSON.parse(a.constitutionTestRecordContent);if(o){t=o.type;var r=e.returnConsStr(t),s=e.returnConsReamk(t);i.find(".reamk").empty().append(s),i.find(".name").text(r),i.find(".share").show(),$("#copyUrl").text(window.location.protocol+"//"+window.location.host+"/wap/view/choose/share.html?id="+n)}else window.location.href="/web/view/choose/"}}):window.location.href="/web/view/choose/";this.getProdsByconsId(t),this.pageEvent()},pageEvent:function(){var e=$(".result-wrap"),t=$("#shareCon");e.find(".re-next").click(function(){e.hide(),$(".recommend-wrap").show()}),e.find(".share").click(function(){t.show().animate({bottom:0})}),t.find(".close").click(function(){t.animate({bottom:-200},function(){t.hide()})});var n=new Clipboard("#idCopy",{text:function(){return $("#copyUrl").html()}});n.on("success",function(e){e.clearSelection(),t.find(".copy .info").fadeIn(2e3,function(){t.find(".copy .info").fadeOut(2e3)})}),n.on("error",function(e){alert("复制失败，请手动复制")})},returnConsStr:function(e){var t="";return 1==e?t="平和体质":2==e?t="气虚体质":3==e?t="阳虚体质":4==e?t="阴虚体质":5==e?t="痰湿体质":6==e?t="湿热体质":7==e?t="血瘀体质":8==e?t="气郁体质":9==e&&(t="特禀体质"),t},returnConsReamk:function(e){var t="";return 1==e?t="<p>平和体质的您简直就是人 赢家嘛!</p><p> 身体倍儿棒，吃嘛嘛香”， 再加上睡眠好、性格开朗， 社会 和自然适应能力强，拥有这类体质的你不爱得病，病也不爱 你！所以说只要不太过分，你可以任性地吃喝拉撒啊!喝各类茶饮皆可</p><p>夸张点来形容，所谓百无禁忌就是你们了。所以你们喝各类茶饮皆可。到了春季喝绿茶；夏季喝白茶、绿茶；秋季喝乌龙茶；冬季喝红茶、普洱熟茶、陈年普洱生茶。想喝的话，那就随着你的性子喝好了。 </p>":2==e?t="<p>气虚体质的你……是不是很容易说话没劲呢，经常出虚汗，容易呼吸短促，经常疲乏无力...</p><p>气虚的人很容易感冒啊，而且你生病后，由于抗病能力弱也难以很快痊愈...</p><p>未发酵和轻发酵的茶就少喝或者不喝吧，红茶、乌龙茶及普洱熟茶都是不错的选择。对你有好处的，注意到共同点了吗？它们都是温和型。</p>":3==e?t="<p>阳虚体质的你是……上辈子折翼的天使，手脚冰凉，跟生鱼片这一类的凉菜有仇，一吃就拉肚子。</p><p>性格多内向、沉静，看似“静如处子，只想在角落里当个美女(男)子”，其实是虚！是懒！不想动而已...</p><p>反正，你就像生命缺少太阳，暖什么的与你无缘...</p>":4==e?t="<p>阴虚体质的你是……热、热、热，夏天就是噩梦；</p><p>手脚心总赶脚被时时加热；不涂胭脂，也是面颊通红； </p><p>渴、渴、渴，为什么喝很多水，还是口干舌燥？无论怎么补水，还是皮肤干燥? 晚上，连周公都不搭理你。</p><p>有时间泡点绿茶、黄茶、白茶等清爽的茶类喝喝吧。例如福鼎寿眉、白牡丹。不想清饮，也可来点花式调饮，比如来点银耳茶、桑葚茶和枸杞红枣茶等。</p>":5==e?t="<p>痰湿体质的你是……心宽体胖是你的最大特点，腹部松软的肉肉总是舍不得离开你；皮肤老是油油腻腻，清爽通透总与你无关；</p><p>从不需要汗蒸，因为常常汗如雨下；眼睛是心灵之窗，可你那浮肿的双眼却阻碍了它绽放光芒。</p><p>常常困乏思睡，总觉得睡得不够……</p><p>痰湿体质要注意饮食清淡、排毒，实在忍不住茶瘾，淡淡地泡一些绿茶、红茶和黑茶，解解馋吧。</p>":6==e?t="<p>湿热体质的你是……脸部、鼻尖总是油光锃亮，痘痘总是逗你不断；小伙伴们总难与你亲近，你一开口便异味四窜；</p><p>别人在茅房倍舒爽，你却惆怅怎么告别黏滞不爽的大便与发黄的小便。</p><p>总而言之，湿热体质的你，总是感觉排泄不畅，怎么洗也还是不清爽，抓狂。</p><p>湿热体质的你自然需要来点甘平排毒的好饮品，绿茶、白茶、黑茶是不错的选择。</p>":7==e?t="<p>血瘀体质的你是……其实很年轻，脸上永远都似蒙着一层灰，晦暗地怎么洗都洗不干净；</p><p>别人磕碰一下没事，你却身上红一块紫一块；本是挤得出水的肤质，你却偏偏干燥粗糙；</p><p>总而言之，你经常被无形抬高年龄。</p><p>血瘀体质的您一定要多顺气啊！没事儿别老生气，平时多喝点红茶、青茶、黑茶及花茶。</p>":8==e?t="<p>气郁体质的你是……李清照的气质，多愁善感、脆弱忧伤；</p><p>祥林嫂的身体，动不得、睡不着是家常事；</p><p>白毛女的容貌，虽年纪轻轻，却是一副冬天被霜打蔫儿、摧残后的掉价白菜的模样...</p><p>总之，如今是一个讲究健康的时代，“林妹妹”早就不吃香了。</p><p>如果你是个气郁体质的人儿，又喜欢喝茶，尽量喝绿茶、青茶、红茶。</p>":9==e&&(t="<p>特禀体质即过敏体质。</p><p>特禀体质的你是……看似小身板不错，鼻涕喷嚏却从未离你而去；因为一点点花粉就能分分钟放倒你；</p><p>别人的美味海鲜，可能是你的致命杀手……总而言之，一旦遇到特定物质，身体就会迅速有过敏反应。</p><p>特禀体质的你，堪称人类中最脆弱的纸片人，绝对的重点保护对象.</p><p>敏感体质的你如果心里时刻住着一伙儿茶虫，实在忍受不住它们的调皮，不妨选择绿茶、青茶、黑茶。</p>"),t},getProdsByconsId:function(e){var t=this,n={constitutionInfoId:e};common.commAjax({type:"POST",url:"product/getProductByConstitutionInfoId",data:n,success:function(e){t.goodsListHtml(e)}})},goodsListHtml:function(e){if(e.length){var t="",n=$(".recommend-wrap").find(".prod-list");$.each(e,function(e,n){var i=n.productWapImage,a=n.productName,o="/wap/view/detail?productId="+n.productId;t+='<li class="p-item"><a href="'+o+'"><div class="pro-img"><img src="'+i+'"></div><p class="zh">'+a+"</p></a></li>"}),n.empty().append(t)}}},shareModule={init:function(){var e=common.getParamsString("id"),t=this;if(e){var n=$("#shareWrap");common.commAjax({type:"POST",url:"constitution/getConstitutionTestRecord",data:{constitutionTestRecordId:e},success:function(e){var i=JSON.parse(e.constitutionTestRecordContent);if(i){var a=[];$.each(i.grades,function(e,t){a[e]=t.sub}),t.createEchart(a),n.find(".cons-name .name").text(t.returnConsStr(i.type));var o=t.returnConsContent(i.type);n.find(".reamk").empty().append(o)}else window.location.href="/wap/view/choose/"}})}else window.location.href="/wap/view/choose/"},createEchart:function(e){var t=echarts.init(document.getElementById("cons"));option={title:{text:"",left:"center"},tooltip:{trigger:"item",formatter:"{c}分为{b}"},legend:{left:"left"},xAxis:{type:"category",splitLine:{show:!1},data:["平和","气虚","阳虚","阴虚","痰湿","湿热","血瘀","气郁","特禀"],nameTextStyle:{color:"#FFF"},axisLabel:{textStyle:{fontSize:12,color:"#FFF"}}},yAxis:{max:100,interval:20,show:!1,splitLine:{show:!1}},axisLine:{show:!0},series:[{name:"体质分数",type:"line",data:e,tooltip:{trigger:"item",formatter:"{a} <br/>{b}体质 : {c}"},itemStyle:{normal:{color:"#FFF"}},lineStyle:{normal:{color:"#FFF"}},markLine:{symbol:"arrow",symbolSize:1,data:[{name:"倾向",yAxis:30},{yAxis:40,name:"判定",lineStyle:{normal:{type:"solid"}}}]}}]},t.setOption(option)},returnConsStr:function(e){var t="";return 1==e?t="平和体质":2==e?t="气虚体质":3==e?t="阳虚体质":4==e?t="阴虚体质":5==e?t="痰湿体质":6==e?t="湿热体质":7==e?t="血瘀体质":8==e?t="气郁体质":9==e&&(t="特禀体质"),t},returnConsContent:function(e){var t="";return 1==e?t='<p class="tit">你的好友居然是令人艳羡、值得称赞的平和体质。平和质应有的特点：体型比较匀称；皮肤光洁如初；很少对人发怒；善于社交沟通。</p><p>记得提醒他/她做到</p><p>要：不熬夜，吃早餐，常运动，多微笑</p><p>不要：睡懒觉，吃宵夜，长时间看电脑</p>':2==e?t='<p class="tit">你的好友是气虚体质，所以他可能总是一副软绵绵、懒洋洋的样子；或者经常丢三落四的。朋友中头几个感冒的总是他，还经常不开心。</p><p>记得提醒他/她做到</p><p>要：早起沐浴阳光，口味清淡滋润， 多些耐心</p><p>不要：暴饮暴食，运动过度，吃宵夜，过多关注自己。</p>':3==e?t='<p class="tit">你的好友是阳虚体质，所以他可能会穿的特多，却还是喊着冷；会常常咬到自己的舌头；顶着一对儿熊猫眼；情绪低落，积极不起来</p><p>记得提醒他/她做到</p><p>要：细嚼慢咽，培养一个爱好，早睡早起，参加公益，分享爱心。</p><p>不要：吃冷饮，熬夜，久坐不动，心生怨念。</p>':4==e?t='<p class="tit">你的好友是阴虚体质，所以他可能喜欢光脚踩着凉地板；最爱喝冷饮；皮肤苍白或者泛红；总是一副干到脱水的样子；脾气暴躁。</p><p>记得提醒他/她做到</p><p>要：早起沐浴阳光，口味清淡滋润， 多些耐心</p><p>不要：超过23点睡觉，怒火中烧，大汗淋漓</p>':5==e?t='<p class="tit">你的好友是痰湿体质，所以他可能容易发胖或者已经发胖；脚步声音，屁股坐下去就不爱起来；不喜欢喝水；脾气好，性格温和。</p><p>记得提醒他/她做到</p><p>要：吃到七分饱，规律运动，泡泡热水澡，细嚼慢咽</p><p>不要：喝冷饮，思虑过度，暴饮暴食</p>':6==e?t='<p class="tit">你的好友是湿热体质，所以他可能脸上看起来总像洗不干净；经常东一片、西一片的冒痘出来；飘飘然过留下一股汗味儿；遇事紧张兮兮；时不常怒发冲冠。</p><p>记得提醒他/她做到</p><p>要：23点前睡觉，一起去运动，保持欢喜并淡定</p><p>不要：烟酒过度，久处潮湿之地，大鱼大肉</p>':7==e?t='<p class="tit">你的好友是血瘀体质，所以他可能脸上有一些暗暗的痤疮印；喜欢摆一副耗呆的表情；丢三落四的爱忘事儿；经常心烦气躁。</p><p>记得提醒他/她做到</p><p>要：培养一个爱好，适度运动，早起早睡</p><p>不要：独自怨念，饮食寒凉，暴饮暴食</p>':8==e?t='<p class="tit">你的好友是气郁体质，所以他可能脸色发黄，没有光泽；经常听到莫名其妙地叹气声；脾气古怪，常在郁闷、发邪火之间摆荡。</p><p>记得提醒他/她做到</p><p>要：充分表达，知足常乐，在阳光下运动，参与公益，分享爱心</p><p>不要：暴饮暴食，冲动购物，熬夜伤神</p>':9==e&&(t='<p class="tit">你的好友是特禀体质，所以他可能喷嚏一连打好几个；这个碰不得，那个碰不得，万事小心翼翼；皮肤一抓就红了，并出现抓痕。</p><p>记得提醒他/她做到</p><p>要：口味清淡自然，情绪从容大度，起居规律不熬夜</p><p>不要：劳汗当风，暴饮暴食，积攒压力</p>'),t}},commentModule={commentData:{},init:function(){this.commentData.character=0,this.commentData.experience=0,this.commentData.speed=0,this.pageEvent()},pageEvent:function(){var e=$("#commentPage"),t=this;e.find(".star-wrap .star").click(function(){var e=$(this).attr("value"),n=$(this).parent();n.find(".star").removeClass("active"),n.find(".star:lt("+e+")").addClass("active");var i=n.attr("type");1==i?t.commentData.character=e:2==i?t.commentData.experience=e:3==i&&(t.commentData.speed=e)}),$("#confirm").click(function(){var n="";if(0==(a=t.commentData).character?n="请为茶叶品质评分":0==a.experience?n="请为服务体验评分":0==a.speed&&(n="请为配送速度评分"),""!=n)common.errorMessage(n,e);else{var i=$('<div class="error-mes"><span>正在提交...</span></div>');e.append(i);var a=t.commentData,o=$("#reamk").val(),r={quality:a.character,service:a.experience,deliverySpeed:a.speed,content:o};common.commAjax({type:"POST",url:"comment/add",data:r,success:function(e){window.location.href="/wap/view/comment/success.html"},error:function(){i.hide();common.errorMessage("服务器异常！",e)}})}})}},detailModule={init:function(){this.getDetailInfo(),this.pageEvent()},getDetailInfo:function(){var e=this,t=common.getParamsString("productId");t&&common.commAjax({type:"POST",url:"product/detail",data:{productId:t},success:function(t){if(t){var n=$("#detailPage");n.find(".detail-content").empty().append(t.productDetailWap).show(),n.find(".prod-name").text(t.productName),$("#jd").attr("href",t.jdPurchaseAddress),$("#youzan").attr("href",t.youzanPurchaseAddress),$("#productOuterPacking").attr("src",t.productOuterPacking),$("#productInnerPacking").attr("src",t.productInnerPacking),e.reportShow(t.reports),$('meta[name="description"]').attr("content",t.content),$('meta[name="keywords"]').attr("content",t.productSEO),document.title=t.productName}}})},pageEvent:function(){var e=$("#detailPage"),t=$("#reportLayer");t.css("height",window.screen.height),e.find(".look-reports").click(function(){t.css("top",0)}),t.find(".close").click(function(){t.css("top","-200%")})},reportShow:function(e){if(e){var t=JSON.parse(e),n="";$.each(t,function(e,t){var i=t.url;0==e&&$("#reportMain").attr("src",i),n+='<div class="swiper-slide"><img src="'+i+'" ></div>'}),$("#reportLayer").find(".swiper-wrapper").empty().append(n),setTimeout(function(){var e=new Swiper(".swiper-container",{grabCursor:!0,paginationClickable:!0,calculateHeight:!0});$(".swiper-button-next").on("click",function(t){t.preventDefault(),e.swipePrev()}),$(".swiper-button-prev").on("click",function(t){t.preventDefault(),e.swipeNext()})},1e3)}},detailInfoHtml:function(e){var t=e.productDetailBOList,n="",i=t.length;if(i){for(var a=$("#detailPage").find(".swiper-wrapper"),o=0;o<i;o++){var r=t[o];n+='<div class="swiper-slide" style="background:url('+r.productWapBgImage+')"><div class="slide-left "><p class="con-text"><img src="'+r.productDetailDescribeImage+'"></p></div><div class="opacity"></div></div>'}a.html("").append(n);new Swiper(".swiper-container",{pagination:".pagination",paginationClickable:!1,mode:"vertical",loop:!0,onSlideChangeEnd:function(e){}})}}},giftModule={swiper:null,init:function(){var e=$("#giftPage").find(".swiper-slide").length;this.swiper=new Swiper(".swiper-container",{pagination:".pagination",paginationClickable:!1,mode:"vertical",speed:1e3,onSlideChangeEnd:function(t){t.activeIndex==e-1?$(".pagination").hide():$(".pagination").show()}}),$("#giftPage").find(".swiper-wrapper").show(),this.pageEvent()},pageEvent:function(){var e=this,t=$("#giftPage").find(".gift-form");t.find(".confirm").click(function(){var n=$(".error-message"),i=t.find(".name").val(),a=t.find(".phone").val(),o=t.find(".remark").val(),r="";if(""==i?r="请填写姓名！":""==a&&(r="请填写电话！"),function(e){var t=/^0\d{2,3}-?\d{7,8}$/;return/^1[3|5|8]\d{9}$/.test(e)||t.test(e)}(a)||(r="电话输入有误"),""!=r)n.find(".con").text(r),n.fadeIn(2e3,function(){n.fadeOut(2e3)});else{var s={customerName:i,phone:a,remark:o};e.saveGiftInfo(s)}}),$("#giftPage").find(".btn-event").click(function(){e.swiper.swipeNext()})},saveGiftInfo:function(e){var t=this,n=$(".error-message");n.find(".con").text("正在提交中..."),n.fadeIn(2e3,function(){}),common.commAjax({type:"POST",url:"customize/add",data:e,success:function(e){n.hide(),t.swiper.removeSlide(1);t.swiper.appendSlide('<div class="swiper-slide slide-5"><div class="desc "><p class="gift-text-icon con-text"></p></div></div>')}})}},indexModule={init:function(){this.getTeaList(),this.pageEvent()},pageEvent:function(){var e=$(".swiper-container").find(".swiper-main").length,t=new Swiper(".swiper-container",{mode:"vertical",keyboardControl:!0,mousewheelControl:!0,speed:600,resistance:"100%",onSlideChangeEnd:function(n){var i=t.activeIndex,a=$(".footer-fixed");i==e-1?(a.removeClass("footer-hide").css("bottom",-a.height()),a.delay(50).animate({bottom:0},500),$(".arrow").hide()):(a.addClass("footer-hide"),$(".arrow").show())}})},getTeaList:function(){var e=this;common.commAjax({type:"POST",url:"product/list",success:function(t){t.length>0&&e.teaSwiperResolve(t)}})},teaSwiperResolve:function(e){var t=$(".swiper-prod"),n=$(".tea-map");$.each(e,function(e,n){var i="/web/view/detail?productId="+n.productId,a=n.brefDesc,o='<div class="p-img"><img src="'+n.productWapImage+'"></div><div class="p-info"><p class="p-name">'+n.productName+'</p><p class="p-remak">'+n.content+'</p><a href="'+i+'" class="p-detail">查看详情</a></div>';t.find("."+a).append(o)}),t.show();new Swiper(".swiper-prod",{autoplay:5e3,onSlideChangeEnd:function(e){var t=e.activeIndex;n.find(".t-item").removeClass("active"),n.find(".tea-"+(t+1)).addClass("active")}});n.find(".t-item").show()}},newsModule={init:function(){this.getNewsList()},getNewsList:function(){var e=this;common.commAjax({type:"POST",url:"news/list",data:{pageNum:page,pageSize:5},success:function(t){e.goodsState=1,e.NewsListHtml(t.resultList),totalPage=t.totalPage}})},NewsListHtml:function(e){if(e){for(var t=e.length,n="",i=$(".news-list"),a=0;a<t;a++){var o=e[a],r=o.title,s=o.mainPicture,c=o.timeCreated,d=o.briefContent,p="/web/view/news-details?newsId="+o.id;n+='<div class="news-item" id='+o.id+'><div  class="pull-left"><img src="'+s+'" /></div><div class="pull-right news-right"><h4>'+r+'</h4><p class="news-time">'+c+'</p><p class="news-content">'+d+'</p><a href="'+p+'">了解详情</a></div></div>'}i.append(n)}},toPage:function(e){page<totalPage&&(page++,this.getNewsList())}},newsDetailModules={init:function(){this.getNewsList()},getNewsList:function(){var e=this;common.commAjax({type:"POST",url:"news/detail",data:{id:common.getParamsString("newsId")},success:function(t){e.NewsListHtml(t)}})},NewsListHtml:function(e){if(e){e.length;var t=$(".news-body");t.find("h1").text(e.title),t.find(".news-time").text(e.publishTime),t.find(".synopsis").text(e.briefContent),t.find("img").attr("src",e.mainPicture),t.find(".content").append(e.detailContent)}}},productModule={init:function(){this.getGoodsList()},getGoodsList:function(){var e=this;common.commAjax({type:"POST",url:"product/list",success:function(t){e.goodsListHtml(t)}})},goodsListHtml:function(e){if(e){for(var t=e.length,n="",i=$("#prodList"),a=0;a<t;a++){var o=e[a],r=o.productName,s=o.productWapImage;n+=' <li class="p-item"><a href="'+("/web/view/detail?productId="+o.productId)+'"><div class="pro-img"><img src="'+s+'" alt="'+r+'"></div><p class="zh">'+r+"</p></a></li>"}i.append(n)}}},storyNewModule={swiper:null,init:function(){var e=0,t=0;this.swiper=new Swiper(".swiper-container",{paginationClickable:!1,mode:"vertical",speed:800,moveStartThreshold:80,resistance:"100%",onTouchStart:function(n){e=n.touches.current,t=n.activeIndex},onTouchMove:function(n){n.touches.current-e>100&&2!=t&&$(".main-layer").fadeIn()},onSlideChangeEnd:function(e,n,i){1==e.activeIndex||2==e.activeIndex?(2==t?$(".main-layer").hide():$(".main-layer").fadeOut(500),$(".head-wrap").addClass("head-back"),$(".two-layer").addClass("active-layer")):($(".main-layer").fadeIn(),$(".head-wrap").removeClass("head-back"),$(".two-layer").removeClass("active-layer"))}}),this.pageEvent()},pageEvent:function(){var e=$("#storyNew"),t=this;e.find(".main-layer .more-nar").click(function(){t.swiper.swipeNext()}),e.find(".two-layer .more-nar").click(function(){t.swiper.swipeNext()}),e.find(".three-layer .more-nar").click(function(){t.swiper.swipePrev()})}};