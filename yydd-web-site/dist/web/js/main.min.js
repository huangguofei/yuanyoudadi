var common={path:"",swiperObj:null,goodsState:0,init:function(){window.location.host;var e=window.location.href;e.indexOf("yuanyoudadi.com")>=0&&(window.location.href=e.replace("yuanyoudadi.com","naturalgiving.cn"));var t=this,i=document.documentElement,n="orientationchange"in window?"orientationchange":"resize",a=function(){t.detectmob(i.clientWidth)};a(),window.attachEvent||(window.addEventListener(n,a,!1),document.addEventListener("DOMContentLoaded",a,!1)),setTimeout(function(){$("#headBuy").hover(function(){t.leftNarLayer()}),t.headerNarFade()},500)},detectmob:function(e){if(!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)))return!1;if(navigator.userAgent.match(/Android/i)){if(e<=768){t=window.location.href;window.location.href=t.replace("web","wap")}}else{var t=window.location.href;window.location.href=t.replace("web","wap")}},pageSwiper:function(e){var t=e.find(".swiper-slide").length,i=0;if(!$(".swiper-container"))return!1;this.swiperObj=new Swiper(".swiper-container",{pagination:".pagination",paginationClickable:!0,mode:"vertical",keyboardControl:!0,mousewheelControl:!0,speed:600,onSlideChangeEnd:function(e){}}),this.swiperObj.wrapperTransitionEnd(function(e){var n=e.activeIndex,a=$(".footer-fixed");if(!a)return!1;n==t-1?1==i?(a.removeClass("footer-hide").css("bottom",-a.height()),a.animate({bottom:0},500)):i=1:a.addClass("footer-hide")},!0),$(".swiper-container").find(".swiper-wrapper").show()},commonEvent:function(){$(".swiper-container").find(".colse-footer").click(function(){var e=$(".footer-fixed");e.animate({bottom:-e.height()},500,function(){e.addClass("footer-hide")})})},headerNarFade:function(){var e=this;$(".swiper-container-nar").length&&(this.narSwiper=new Swiper(".swiper-container-nar",{paginationClickable:!1,mode:"vertical",speed:600,moveStartThreshold:80,resistance:"100%",mousewheelControl:!0}));var t=$("#narList").hide();$("#wapNar").click(function(){$(this);t.show().animate({right:0},300).find(".bg-layer").show(),$("#goodsPage").animate({left:"-100%"},500)}),t.find(".close").click(function(){t.animate({right:"-100%"},300,function(){t.hide()})}),t.find(".more-nar").click(function(){e.narSwiper.swipeNext()}),t.find(".close-top").click(function(){e.narSwiper.swipePrev()}),t.find(".bg-layer").click(function(e){$(this).hide(),t.animate({right:"-100%"},300,function(){t.hide()})}),$("#leftNar").find(".bg-layer").click(function(e){$(this).hide(),$("#leftNar").css("overflow-y","hidden").animate({left:"-100%"},500)}),$("#upComing").find(".close").click(function(){$("#upComing").animate({right:"-100%"},300,function(){$(this).hide()})}),this.commonEvent()},openUpComing:function(){$("#upComing").show().animate({right:0},300)},commAjax:function(e){if(e){var t="";e.url&&(t=this.path+"/yydd-web/"+e.url),$.ajax({url:t,type:e.type?e.type:"POST",cache:!1,data:e.data?e.data:null,async:!1!==e.async,dataType:e.dataType?e.dataType:"json",beforeSend:function(e){return!0},success:e.success?function(t){var i=t.data;200==t.code?e.success(i):alert(t.msg)}:function(e){},error:e.error?e.error:function(e,t,i){alert("服务器异常，请稍候再试")}})}},getParamsString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(t);return null!=i?unescape(i[2]):null},leftNarLayer:function(){var e=$("#leftNar");e.animate({left:"0"},500,function(){e.find(".bg-layer").show(),e.css("overflow-y","auto")})},closeLeftNar:function(){$("#leftNar").css("overflow-y","hidden").animate({left:"-100%"},500)},narActive:function(e){var t=$("#headNar").find(".nar").find("."+e);t&&t.addClass("active")},copyToClipboard:function(e){if(window.clipboardData)window.clipboardData.setData("Text",e);else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){alert("该浏览器不支持一键复制！n请手工复制文本框链接地址～")}var t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return;var i=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!i)return;i.addDataFlavor("text/unicode");var n=new Object,a=(new Object,e);(n=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString)).data=a,i.setTransferData("text/unicode",n,2*a.length);var r=Components.interfaces.nsIClipboard;if(!t)return!1;t.setData(i,null,r.kGlobalClipboard)}}};common.init();var chooseModule={swiperObj:null,init:function(){this.swiperObj=new Swiper(".swiper-container",{paginationClickable:!0,mode:"vertical",keyboardControl:!0,mousewheelControl:!0,speed:600,resistance:"100%",onSlideChangeEnd:function(e){}}),$(".swiper-container").find(".slide-2 .container").show(),this.pageEvent()},pageEvent:function(){var e=$("#chooseSwiper"),t=this,i=e.find(".cor-list");i.find(".c-item").click(function(){i.find(".c-item").removeClass("active"),$(this).addClass("active")});var n=e.find(".select-cor");n.find(".next").click(function(){var e=n.find(".cor-list .active"),t=$(".isSubmit"),i=$(this);if(!t.is(":hidden"))return!1;if(e.length){var a=e.attr("key");window.location.href="/web/view/choose/result.html?type="+a}else i.find(".info").fadeIn(2e3,function(){i.find(".info").fadeOut(2e3)})}),e.find(".choose-event").click(function(){t.swiperObj.swipeNext()})}},quizModule={swiperObj:null,type:null,init:function(){this.pageEvent(),this.initSwiper(),$(".swiper-container").find(".slide-3 .container").show()},initSwiper:function(){this.swiperObj=new Swiper(".swiper-container",{pagination:".pagination",paginationClickable:!0,mode:"vertical",keyboardControl:!0,mousewheelControl:!0,speed:600,resistance:"100%",onSlideChangeEnd:function(e){}})},pageEvent:function(){var e=$("#quizSwiper"),t=this,i=e.find(".subject-wrap");e.find(".testing").click(function(){t.swiperObj.swipeNext()}),i.find(".a-item").click(function(){var e=$(this),t=e.parent();if(t.hasClass("enabled")){t.find(".a-item").removeClass("active"),e.addClass("active");var i=t.parent().next();if(i){if(i.find(".answer").addClass("enabled"),i.hasClass("row-active"))return!1;t.parent().addClass("row-active").removeClass("row-select"),i.addClass("row-select")}}}),i.find(".next").click(function(){var e=i.find(".sub-active"),t=$(".conr-con").find(".con-active"),n=e.find(".active").length,a=e.find(".issue").length,r=$(this);if(n<a)r.find(".info").fadeIn(2e3,function(){r.find(".info").fadeOut(2e3)});else{e.removeClass("sub-active"),t.removeClass("con-active");var o=e.next().index();o>0?(e.next().addClass("sub-active"),t.next().addClass("con-active"),i.find(".prev").show(),o==i.find(".sub-item").length-1?(i.find(".next").hide(),i.find(".confim").show()):i.find(".confim").hide()):i.find(".prev").hide()}}),i.find(".prev").click(function(){var e=i.find(".sub-active"),t=$(".conr-con").find(".con-active"),n=(e.find(".active").length,i.find(".sub-item").length),a=$(this);e.removeClass("sub-active"),t.removeClass("con-active");var r=e.prev().addClass("sub-active");t.prev().addClass("con-active");var o=r.index();0==o?a.hide():o<n-1&&(i.find(".next").show(),i.find(".confim").hide())}),i.find(".confim").click(function(){var e=$(".isSubmit"),n=$(this),a=i.find(".sub-active"),r=a.find(".active").length,o=a.find(".issue").length;if(!e.is(":hidden"))return!1;if(r<o)n.find(".info").fadeIn(2e3,function(){n.find(".info").fadeOut(2e3)});else{var s=[];i.find(".sub-item").each(function(e){var t=$(this),i=t.attr("key"),n=t.attr("val"),a=t.find(".issue").length,r=s[e]={grade:[],sub:0,type:i,name:n},o=0;t.find(".issue").each(function(e){var t=$(this).find(".active").attr("key");r.grade[e]=t,o+=Number(t)}),r.sub=100*[(o-a)/(4*a)]}),t.submitChoose(s)}})},detectionConstitution:function(e){var t=0,i=0,n=-1,a="",r=0,o=-1,s=0;$.each(e,function(e,a){var s=a.sub;0==e?t=s:(s>=40&&(++i,n=e),r<s&&(r=s,o=e))}),t>=60&&0==i?(a=e[0].name,s=1):i>0&&r>=e[n].sub?(a=e[o].name,s=e[o].type):i>0&&r<e[n].sub?(a=e[n].name,s=e[n].type):0==i&&r>30?(a=e[o].name,s=e[o].type):(a=e[0].name,s=1);var c={type:s,grades:e};return{name:a,type:s,grades:JSON.stringify(c)}},submitChoose:function(e){var t=this,i=$(".isSubmit");i.show();var n=t.detectionConstitution(e);n.name,n.type,common.commAjax({type:"POST",url:"constitution/addConstitutionTestRecord",data:{testRecord:n.grades},success:function(e){i.hide(),"pad"==t.type?window.location.href="/web/view/choose/pad-result.html?id="+e:window.location.href="/web/view/choose/result.html?id="+e}})}},resultModelu={init:function(){var e=this,t=common.getParamsString("type"),i=common.getParamsString("id"),n=$("#resultWrap");if(t){n.find(".share").remove();var a=this.returnConsStr(t),r=this.returnConsReamk(t);n.find(".reamk").empty().append(r),n.find(".name").text(a),e.getProdsByconsId(t)}else i?common.commAjax({type:"POST",url:"constitution/getConstitutionTestRecord",data:{constitutionTestRecordId:i},success:function(a){var r=JSON.parse(a.constitutionTestRecordContent);if(r){t=r.type;var o=e.returnConsStr(t),s=e.returnConsReamk(t);n.find(".reamk").empty().append(s),n.find(".name").text(o),e.getProdsByconsId(t),n.find(".share").show(),$("#copyUrl").val(window.location.protocol+"//"+window.location.host+"/web/view/choose/share.html?id="+i)}else window.location.href="/web/view/choose/"}}):window.location.href="/web/view/choose/";r=e.returnConsReamk(t);this.pageEvent()},pageEvent:function(){var e=$("#resultWrap"),t=$("#shareCon");e.find(".share").click(function(){t.show().animate({bottom:0})}),t.find(".close").click(function(){t.animate({bottom:-200},function(){t.hide()})});var i=new Clipboard(".copy");i.on("success",function(e){e.trigger.getAttribute("aria-label"),e.clearSelection(),t.find(".copy .info").fadeIn(2e3,function(){t.find(".copy .info").fadeOut(2e3)})}),i.on("error",function(e){alert("您的浏览器不支持一键复制，请手动复制")})},returnConsStr:function(e){var t="";return 1==e?t="平和体质":2==e?t="气虚体质":3==e?t="阳虚体质":4==e?t="阴虚体质":5==e?t="痰湿体质":6==e?t="湿热体质":7==e?t="血瘀体质":8==e?t="气郁体质":9==e&&(t="特禀体质"),t},returnConsReamk:function(e){var t="";return 1==e?t="<p>平和体质的您简直就是人 赢家嘛!</p><p> 身体倍儿棒，吃嘛嘛香”， 再加上睡眠好、性格开朗， 社会 和自然适应能力强，拥有这类体质的你不爱得病，病也不爱 你！所以说只要不太过分，你可以任性地吃喝拉撒啊!喝各类茶饮皆可</p><p>夸张点来形容，所谓百无禁忌就是你们了。所以你们喝各类茶饮皆可。到了春季喝绿茶；夏季喝白茶、绿茶；秋季喝乌龙茶；冬季喝红茶、普洱熟茶、陈年普洱生茶。想喝的话，那就随着你的性子喝好了。 </p>":2==e?t="<p>气虚体质的你……是不是很容易说话没劲呢，经常出虚汗，容易呼吸短促，经常疲乏无力...</p><p>气虚的人很容易感冒啊，而且你生病后，由于抗病能力弱也难以很快痊愈...</p><p>未发酵和轻发酵的茶就少喝或者不喝吧，红茶、乌龙茶及普洱熟茶都是不错的选择。对你有好处的，注意到共同点了吗？它们都是温和型。</p>":3==e?t="<p>阳虚体质的你是……上辈子折翼的天使，手脚冰凉，跟生鱼片这一类的凉菜有仇，一吃就拉肚子。</p><p>性格多内向、沉静，看似“静如处子，只想在角落里当个美女(男)子”，其实是虚！是懒！不想动而已...</p><p>反正，你就像生命缺少太阳，暖什么的与你无缘...</p>":4==e?t="<p>阴虚体质的你是……热、热、热，夏天就是噩梦；</p><p>手脚心总赶脚被时时加热；不涂胭脂，也是面颊通红； </p><p>渴、渴、渴，为什么喝很多水，还是口干舌燥？无论怎么补水，还是皮肤干燥? 晚上，连周公都不搭理你。</p><p>有时间泡点绿茶、黄茶、白茶等清爽的茶类喝喝吧。例如福鼎寿眉、白牡丹。不想清饮，也可来点花式调饮，比如来点银耳茶、桑葚茶和枸杞红枣茶等。</p>":5==e?t="<p>痰湿体质的你是……心宽体胖是你的最大特点，腹部松软的肉肉总是舍不得离开你；皮肤老是油油腻腻，清爽通透总与你无关；</p><p>从不需要汗蒸，因为常常汗如雨下；眼睛是心灵之窗，可你那浮肿的双眼却阻碍了它绽放光芒。</p><p>常常困乏思睡，总觉得睡得不够……</p><p>痰湿体质要注意饮食清淡、排毒，实在忍不住茶瘾，淡淡地泡一些绿茶、红茶和黑茶，解解馋吧。</p>":6==e?t="<p>湿热体质的你是……脸部、鼻尖总是油光锃亮，痘痘总是逗你不断；小伙伴们总难与你亲近，你一开口便异味四窜；</p><p>别人在茅房倍舒爽，你却惆怅怎么告别黏滞不爽的大便与发黄的小便。</p><p>总而言之，湿热体质的你，总是感觉排泄不畅，怎么洗也还是不清爽，抓狂。</p><p>湿热体质的你自然需要来点甘平排毒的好饮品，绿茶、白茶、黑茶是不错的选择。</p>":7==e?t="<p>血瘀体质的你是……其实很年轻，脸上永远都似蒙着一层灰，晦暗地怎么洗都洗不干净；</p><p>别人磕碰一下没事，你却身上红一块紫一块；本是挤得出水的肤质，你却偏偏干燥粗糙；</p><p>总而言之，你经常被无形抬高年龄。</p><p>血瘀体质的您一定要多顺气啊！没事儿别老生气，平时多喝点红茶、青茶、黑茶及花茶。</p>":8==e?t="<p>气郁体质的你是……李清照的气质，多愁善感、脆弱忧伤；</p><p>祥林嫂的身体，动不得、睡不着是家常事；</p><p>白毛女的容貌，虽年纪轻轻，却是一副冬天被霜打蔫儿、摧残后的掉价白菜的模样...</p><p>总之，如今是一个讲究健康的时代，“林妹妹”早就不吃香了。</p><p>如果你是个气郁体质的人儿，又喜欢喝茶，尽量喝绿茶、青茶、红茶。</p>":9==e&&(t="<p>特禀体质即过敏体质。特禀体质的你是……看似小身板不错，鼻涕喷嚏却从未离你而去；因为一点点花粉就能分分钟放倒你；</p><p>别人的美味海鲜，可能是你的致命杀手……总而言之，一旦遇到特定物质，身体就会迅速有过敏反应。</p><p>特禀体质的你，堪称人类中最脆弱的纸片人，绝对的重点保护对象.</p><p>敏感体质的你如果心里时刻住着一伙儿茶虫，实在忍受不住它们的调皮，不妨选择绿茶、青茶、黑茶。</p>"),t},getProdsByconsId:function(e){var t=this,i={constitutionInfoId:e},n="";common.commAjax({type:"POST",url:"product/getProductByConstitutionInfoId",data:i,success:function(e){n=t.goodsListHtml(e);var i=$("#resultWrap");""==n&&(n="<p class='no-data'>未找到该体质的茶叶</p>"),i.find(".prod-list").empty().append(n)}})},goodsListHtml:function(e){var t="";return e.length&&$.each(e,function(e,i){var n=i.productWapImage,a=i.productName,r="/wap/view/detail?productId="+i.productId;t+='<li class="p-item"><a href="'+r+'"><div class="pro-img"><img src="'+n+'"></div><p class="zh">'+a+"</p></a></li>"}),t}},shareModule={init:function(){var e=common.getParamsString("id"),t=this;if(e){var i=$("#shareWrap");common.commAjax({type:"POST",url:"constitution/getConstitutionTestRecord",data:{constitutionTestRecordId:e},success:function(e){var n=JSON.parse(e.constitutionTestRecordContent);if(n){var a=[];$.each(n.grades,function(e,t){a[e]=t.sub}),t.createEchart(a),i.find(".cons-name").text(t.returnConsStr(n.type));var r=t.returnConsContent(n.type);i.find(".reamk").empty().append(r)}else window.location.href="/web/view/choose/"}})}else window.location.href="/web/view/choose/"},createEchart:function(e){var t=echarts.init(document.getElementById("cons"));option={title:{text:"",left:"center"},tooltip:{trigger:"item",formatter:"{c}分为{b}"},legend:{left:"left"},xAxis:{type:"category",splitLine:{show:!1},data:["平和","气虚","阳虚","阴虚","痰湿","湿热","血瘀","气郁","特禀"],nameTextStyle:{color:"#FFF"},axisLabel:{textStyle:{fontSize:14,color:"#FFF"}}},yAxis:{max:100,interval:20,show:!1,splitLine:{show:!1}},axisLine:{show:!0},series:[{name:"体质分数",type:"line",data:e,tooltip:{trigger:"item",formatter:"{a} <br/>{b}体质 : {c}"},itemStyle:{normal:{color:"#FFF"}},lineStyle:{normal:{color:"#FFF"}},markLine:{symbol:"arrow",symbolSize:1,data:[{name:"倾向",yAxis:30},{yAxis:40,name:"判定",lineStyle:{normal:{type:"solid"}}}]}}]},t.setOption(option)},returnConsStr:function(e){var t="";return 1==e?t="平和体质":2==e?t="气虚体质":3==e?t="阳虚体质":4==e?t="阴虚体质":5==e?t="痰湿体质":6==e?t="湿热体质":7==e?t="血瘀体质":8==e?t="气郁体质":9==e&&(t="特禀体质"),t},returnConsContent:function(e){var t="";return 1==e?t='<p class="tit">你的好友居然是令人艳羡、值得称赞的平和体质。平和质应有的特点：体型比较匀称；皮肤光洁如初；很少对人发怒；善于社交沟通。</p><p>记得提醒他/她做到</p><p>要：不熬夜，吃早餐，常运动，多微笑</p><p>不要：睡懒觉，吃宵夜，长时间看电脑</p>':2==e?t='<p class="tit">你的好友是气虚体质，所以他可能总是一副软绵绵、懒洋洋的样子；或者经常丢三落四的。朋友中头几个感冒的总是他，还经常不开心。</p><p>记得提醒他/她做到</p><p>要：早起沐浴阳光，口味清淡滋润， 多些耐心</p><p>不要：暴饮暴食，运动过度，吃宵夜，过多关注自己。</p>':3==e?t='<p class="tit">你的好友是阳虚体质，所以他可能会穿的特多，却还是喊着冷；会常常咬到自己的舌头；顶着一对儿熊猫眼；情绪低落，积极不起来</p><p>记得提醒他/她做到</p><p>要：细嚼慢咽，培养一个爱好，早睡早起，参加公益，分享爱心。</p><p>不要：吃冷饮，熬夜，久坐不动，心生怨念。</p>':4==e?t='<p class="tit">你的好友是阴虚体质，所以他可能喜欢光脚踩着凉地板；最爱喝冷饮；皮肤苍白或者泛红；总是一副干到脱水的样子；脾气暴躁。</p><p>记得提醒他/她做到</p><p>要：早起沐浴阳光，口味清淡滋润， 多些耐心</p><p>不要：超过23点睡觉，怒火中烧，大汗淋漓</p>':5==e?t='<p class="tit">你的好友是痰湿体质，所以他可能容易发胖或者已经发胖；脚步声音，屁股坐下去就不爱起来；不喜欢喝水；脾气好，性格温和。</p><p>记得提醒他/她做到</p><p>要：吃到七分饱，规律运动，泡泡热水澡，细嚼慢咽</p><p>不要：喝冷饮，思虑过度，暴饮暴食</p>':6==e?t='<p class="tit">你的好友是湿热体质，所以他可能脸上看起来总像洗不干净；经常东一片、西一片的冒痘出来；飘飘然过留下一股汗味儿；遇事紧张兮兮；时不常怒发冲冠。</p><p>记得提醒他/她做到</p><p>要：23点前睡觉，一起去运动，保持欢喜并淡定</p><p>不要：烟酒过度，久处潮湿之地，大鱼大肉</p>':7==e?t='<p class="tit">你的好友是血瘀体质，所以他可能脸上有一些暗暗的痤疮印；喜欢摆一副耗呆的表情；丢三落四的爱忘事儿；经常心烦气躁。</p><p>记得提醒他/她做到</p><p>要：培养一个爱好，适度运动，早起早睡</p><p>不要：独自怨念，饮食寒凉，暴饮暴食</p>':8==e?t='<p class="tit">你的好友是气郁体质，所以他可能脸色发黄，没有光泽；经常听到莫名其妙地叹气声；脾气古怪，常在郁闷、发邪火之间摆荡。</p><p>记得提醒他/她做到</p><p>要：充分表达，知足常乐，在阳光下运动，参与公益，分享爱心</p><p>不要：暴饮暴食，冲动购物，熬夜伤神</p>':9==e&&(t='<p class="tit">你的好友是特禀体质，所以他可能喷嚏一连打好几个；这个碰不得，那个碰不得，万事小心翼翼；皮肤一抓就红了，并出现抓痕。</p><p>记得提醒他/她做到</p><p>要：口味清淡自然，情绪从容大度，起居规律不熬夜</p><p>不要：劳汗当风，暴饮暴食，积攒压力</p>'),t}},detailModule={init:function(){this.getDetailInfo(),this.pageEvent()},getDetailInfo:function(){var e=this,t=common.getParamsString("productId");t&&common.commAjax({type:"POST",url:"product/detail",data:{productId:t},success:function(t){if(t){var i=$("#detailPage");i.find(".detail-content").empty().append(t.productDetailPc).show(),i.find(".prod-name").text(t.productName),$("#jd").attr("href",t.jdPurchaseAddress),$("#youzan").attr("href",t.youzanPurchaseAddress),$("#productOuterPacking").attr("src",t.productOuterPacking),$("#productInnerPacking").attr("src",t.productInnerPacking),e.reportShow(t.reports),$('meta[name="description"]').attr("content",t.content),$('meta[name="keywords"]').attr("content",t.productSEO),document.title=t.productName}}})},pageEvent:function(){var e=$("#detailPage"),t=$("#reportLayer");t.css("height",window.screen.height),e.find(".look-reports").click(function(){t.css("top",0)}),t.find(".close").click(function(){t.css("top","-200%")})},reportShow:function(e){if(e){var t=JSON.parse(e),i="";$.each(t,function(e,t){var n=t.url;0==e&&$("#reportMain").attr("src",n),i+='<div class="swiper-slide"><img src="'+n+'" ></div>'}),$("#reportLayer").find(".swiper-wrapper").empty().append(i),setTimeout(function(){var e=new Swiper(".swiper-container",{grabCursor:!0,paginationClickable:!0,calculateHeight:!0});$(".swiper-button-next").on("click",function(t){t.preventDefault(),e.swipePrev()}),$(".swiper-button-prev").on("click",function(t){t.preventDefault(),e.swipeNext()})},1e3)}},detailInfoHtml:function(e){var t=e.productDetailBOList,i="",n=t.length;if(n){for(var a=$("#detailPage").find(".swiper-wrapper"),r=0;r<n;r++){var o=t[r];i+='<div class="swiper-slide" style="background:url('+o.productPcBgImage+') no-repeat center center;background-size: cover;"> <div class="container"><div class="slide-left "><p class="con-text"><img src="'+o.productDetailDescribeImage+'"><a href="javascript:viod(0)"  class="buy btn-event">京东旗舰店</a></p></div></div></div>'}a.html("").append(i);new Swiper(".swiper-container",{pagination:".pagination",paginationClickable:!1,mode:"vertical",loop:!0,onSlideChangeEnd:function(e){}})}}},giftModule={swiper:null,init:function(){$("#giftPage").find(".swiper-slide").length;this.swiper=new Swiper(".swiper-container",{paginationClickable:!1,mode:"vertical",keyboardControl:!0,mousewheelControl:!0,speed:600,resistance:"100%"}),this.pageEvent()},pageEvent:function(){var e=this,t=$("#giftSwiper").find(".gift-info");t.find(".confirm").click(function(){var i=$(".error-message"),n=t.find(".name").val(),a=t.find(".phone").val(),r=t.find(".remark").val(),o="";if(""==n?o="请填写姓名！":""==a?o="请填写电话！":function(e){var t=/^0\d{2,3}-?\d{7,8}$/;return/^1[3|5|8]\d{9}$/.test(e)||t.test(e)}(a)||(o="电话输入有误"),""!=o)i.find(".con").text(o),i.fadeIn(2e3,function(){i.fadeOut(2e3)});else{var s={customerName:n,phone:a,remark:r};e.saveGiftInfo(s)}}),$("#giftSwiper").find(".gift-event").click(function(){e.swiper.swipeNext()}),$(".arrow").click(function(){e.swiper.swipeNext()})},saveGiftInfo:function(e){common.commAjax({type:"POST",url:"customize/add",data:e,success:function(e){var t=$(".error-message");t.find(".con").text("提交成功！"),t.fadeIn(2e3,function(){t.fadeOut(3e3)})}})}},indexModule={init:function(){this.getTeaList(),this.pageEvent()},pageEvent:function(){var e=$(".swiper-container").find(".swiper-main").length,t=new Swiper(".swiper-container",{mode:"vertical",keyboardControl:!0,mousewheelControl:!0,speed:600,resistance:"100%",onSlideChangeEnd:function(i){var n=t.activeIndex,a=$(".footer-fixed");n==e-1?(a.removeClass("footer-hide").css("bottom",-a.height()),a.delay(50).animate({bottom:0},500),$(".arrow").hide()):(a.addClass("footer-hide"),$(".arrow").show())}});$("#swiperDown").click(function(){t.swipeNext()})},getTeaList:function(){var e=this;common.commAjax({type:"POST",url:"product/list",success:function(t){t.length>0&&e.teaSwiperResolve(t)}})},teaSwiperResolve:function(e){var t="",i=this;$.each(e,function(e,i){var n="/web/view/detail?productId="+i.productId,a=(i.productBGPC,i.productIcon,i.brefDesc),r=i.productPcImage;t+='<div class="p-item '+a+'"><div class="p-img"><img src="'+r+'" /></div><p class="p-name">'+i.productName+'</p><p class="p-remak">'+i.content+'</p><a href="'+n+'" class="p-detail">查看详情</a></div>'}),$(".tea-map .prod-reamk").empty().append(t).find(".tea-1").addClass("active"),i.mapEvent()},mapEvent:function(){var e=function(e){$(".tea-map").find(".t-item").removeClass("active"),e.addClass("active");var t=e.attr("value");if(t){var i=$(".prod-reamk");i.find(".p-item").removeClass("active"),i.find("."+t).addClass("active")}};$(".tea-map").find(".t-item").click(function(){e($(this))}),$(".tea-map").find(".t-item").hover(function(){e($(this))})}},newsModule={init:function(){this.getNewsList()},getNewsList:function(){var e=this;common.commAjax({type:"POST",url:"news/list",data:{pageNum:page,pageSize:5},success:function(t){console.log(t),e.goodsState=1,e.NewsListHtml(t.resultList),$(".page>a").length<3&&e.pageCreard(t.totalPage)}})},NewsListHtml:function(e){if(e){var t=e.length,i="",n=$(".news-list");n.empty();for(var a=0;a<t;a++){var r=e[a],o=r.title,s=r.mainPicture,c=r.publishTime,d=r.briefContent,l="/web/view/news-details?newsId="+r.id;i+='<div class="news-item" id='+r.id+'><div class="pull-left"><img  src="'+s+'" /></div><div class="pull-right news-right"><h4>'+o+'</h4><p class="news-time">'+c+'</p><p class="news-content">'+d+'</p><a href="'+l+'">了解详情</a></div></div>'}n.append(i)}},toPage:function(e,t){if("prop"==e)page>1&&(page--,$(".page-num").eq(page-1).addClass("active").siblings().removeClass("active"),this.getNewsList());else if("next"==e){var i=$(".page .page-num").length;page<i&&(page++,$(".page-num").eq(page-1).addClass("active").siblings().removeClass("active"),this.getNewsList())}else $(t).addClass("active").siblings().removeClass("active"),page=e,this.getNewsList()},pageCreard:function(e){if(e){for(var t="",i=0;i<e;i++){var n=i+1;t+='<a href="javascript:;" class="page-num '+(0==i?"active":"")+'" onclick="newsModule.toPage('+n+',this)">'+n+"</a>"}$(".prev").after(t)}}},newsDetailModule={init:function(){this.getNewsList()},getNewsList:function(){var e=this;common.commAjax({type:"POST",url:"news/detail",data:{id:common.getParamsString("newsId")},success:function(t){e.NewsListHtml(t)}})},NewsListHtml:function(e){if(e){e.length;var t=$(".news-body");t.find("h1").text(e.title),t.find(".news-time").text(e.publishTime),t.find(".synopsis").text(e.briefContent),t.find(".content").append(e.detailContent),e.lastId?$(".page").append('<a href="/web/view/news-details?newsId='+e.lastId+'" class="prev">上一篇：'+e.lastTitle+"</a>"):$(".page").append('<a href="javascript:;" class="prev">已经是第一篇了</a>'),e.nextId?$(".page").append('<a href="/web/view/news-details?newsId='+e.nextId+'" class="prev">下一篇：'+e.nextTitle+"</a>"):$(".page").append('<a href="javascript:;" class="prev">已经是最后一篇了</a>')}}},productModule={init:function(){this.getGoodsList()},getGoodsList:function(){var e=this;common.commAjax({type:"POST",url:"product/list",success:function(t){e.goodsState=1,e.goodsListHtml(t)}})},goodsListHtml:function(e){if(e){for(var t=e.length,i="",n=$("#prodList"),a=0;a<t;a++){var r=e[a],o=r.productName,s=r.productWapImage;i+='<li class="p-item"><a href="'+("/web/view/detail?productId="+r.productId)+'"><div class="pro-img"><img src="'+s+'" alt="'+o+'"></div><p class="zh">'+o+"</p></a></li>"}n.append(i)}}},storyNewModule={swiper:null,init:function(){this.swiper=new Swiper(".swiper-container",{paginationClickable:!1,mode:"vertical",speed:800,moveStartThreshold:80,resistance:"100%",keyboardControl:!0,mousewheelControl:!0,cssWidthAndHeight:!0,onTouchStart:function(e){},onTouchMove:function(e){},onSlideChangeEnd:function(e,t,i){e.activeIndex>0?$(".head-wrap").addClass("head-active"):$(".head-wrap").removeClass("head-active");var n=$(".footer-fixed");4==e.activeIndex?($(".slide-5").addClass("last-slide"),n.removeClass("footer-hide").css("bottom",-n.height()),n.delay(500).animate({bottom:0},500),$(".arrow").hide()):($(".slide-5").removeClass("last-slide"),n.addClass("footer-hide"),$(".arrow").show())}}),this.pageEvent()},pageEvent:function(){var e=$("#storyNew"),t=this;e.find(".main-layer .more-nar").click(function(){t.swiper.swipeNext()}),e.find(".two-layer .more-nar").click(function(){t.swiper.swipeNext()}),e.find(".three-layer .more-nar").click(function(){t.swiper.swipePrev()}),$(".arrow").click(function(){t.swiper.swipeNext()})}},editModule={rowId:null,init:function(){this.rowId=common.getParamsString("id"),this.rowId&&this.getUserInfo(this.rowId),this.pageEvent()},pageEvent:function(){var e=$(".user-edit-page"),t=this,i=e.find(".info-con>.panel").length;e.find(".next").click(function(){$(this);var n=e.find(".p-active");if(!t.verificationForm(n,n.index()))return!1;var a=n.next(),r=a.index();a.length&&(n.removeClass("p-active").css("left","100%"),a.addClass("p-active").animate({left:0})),r==i-1?(e.find(".next").hide(),e.find(".confirm").show()):r>0?e.find(".prev").show():e.find(".prev").hide()}),e.find(".prev").click(function(){$(this);var t=e.find(".p-active"),i=t.prev(),n=i.index();i.length&&(t.removeClass("p-active").css("left","100%"),i.addClass("p-active").animate({left:0})),n>0?e.find(".prev").show():e.find(".prev").hide(),e.find(".next").show(),e.find(".confirm").hide()}),e.find(".check-item").click(function(){var e=$(this),t=e.parent();t.hasClass("more-check")?e.hasClass("active")?e.removeClass("active"):e.addClass("active"):(t.find(".check-item").removeClass("active"),e.addClass("active"))}),e.find(".confirm").click(function(){var e=$(".user-edit-page"),i=$('<div class="error-mes"><span>正在提交中...</span></div>');e.append(i),i.fadeIn();var n=t.readFormData(),a="customerInfo/add";t.rowId&&(n.id=t.rowId,a="customerInfo/edit"),common.commAjax({type:"POST",url:a,data:n,success:function(e){e&&(window.location.href="/web/view/user/")},error:function(){i.hide(),t.errorMessage("提交失败！")}})})},errorMessage:function(e){var t=$(".user-edit-page"),i=$('<div class="error-mes"><span>'+e+"</span></div>");t.append(i),i.fadeIn(function(){i.delay(1e3).fadeOut(function(){i.remove()})})},verificationForm:function(e,t){var i=this,n=!0,a="";if(0==t)$("#userName").val()||(n=!1,a="姓名不能为空！");else if(t){var r=$("#tel").val();r?/^1(3|4|5|7|8)\d{9}$/.test(r)||(n=!1,a="电话有错误，请重填！"):(n=!1,a="电话不能为空！")}return n||i.errorMessage(a),n},readFormData:function(){var e=$("#userName").val(),t=$("#sex").find(".active").attr("value"),i=$("#birthday").val(),n=$("#tel").val(),a=$("#weixin").val(),r=$("#card").val(),o=$("#ditch").val(),s=$("#address").val(),c=$("#drink").find(".active").attr("value"),d=$("#frequency").find(".active").attr("value"),l=$("#purpose").find(".active"),p="",f=l.length;$.each(l,function(e){var t=$(this);p+=e==f-1?t.attr("value"):t.attr("value")+","});var u=$("#flavor").find(".active"),v="",m=u.length;$.each(u,function(e){var t=$(this);v+=e==m-1?t.attr("value"):t.attr("value")+","});var h=$("#industry").find(".active"),w="",g=h.length;return $.each(h,function(e){var t=$(this);w+=e==g-1?t.attr("value"):t.attr("value")+","}),{realName:e,gender:t,birthday:i,phone:n,wx:a,identifyCardNum:r,channel:o,address:s,hasDrinkTeaHabit:c,drinkTeaRate:d,forUse:p,flavorHabit:v,industryOwned:w}},getUserInfo:function(e){if(!e)return!1;var t=function(e){if(console.log(e),$("#userName").val(e.realName),$("#birthday").val(e.birthday),$("#tel").val(e.phone),$("#weixin").val(e.wx),$("#ditch").val(e.channel),$("#card").val(e.identifyCardNum),$("#address").val(e.address),""==e.gender&&void 0==e.gender||$("#sex").find(".check-item[value='"+e.gender+"']").addClass("active"),""==e.hasDrinkTeaHabit&&void 0==e.hasDrinkTeaHabit||$("#drink").find(".check-item[value='"+e.hasDrinkTeaHabit+"']").addClass("active"),""==e.drinkTeaRate&&void 0==e.drinkTeaRate||$("#frequency").find(".check-item[value='"+e.drinkTeaRate+"']").addClass("active"),""!=e.forUse||void 0!=e.forUse){var t=e.forUse.split(","),i=$("#purpose");$.each(t,function(e,t){i.find(".check-item[value='"+t+"']").addClass("active")})}if(""!=e.flavorHabit||void 0!=e.flavorHabit){var t=e.flavorHabit.split(","),n=$("#flavor");$.each(t,function(e,t){n.find(".check-item[value='"+t+"']").addClass("active")})}if(""!=e.industryOwned||void 0!=e.industryOwned){var t=e.industryOwned.split(","),a=$("#industry");$.each(t,function(e,t){a.find(".check-item[value='"+t+"']").addClass("active")})}};common.commAjax({type:"POST",url:"customerInfo/detail",data:{id:e},success:function(e){e&&t(e)}})}},userModule={selectPageSize:0,init:function(){this.getUserlist(1)},createRowData:function(e){if(!e)return!1;var t="",i=this;$.each(e,function(e,n){var a=e+1,r=0==n.gender?"男":"女",o=0==n.hasDrinkTeaHabit?"有":"无",s="一天一次";1==n.drinkTeaRate?s="一天多次":2==n.drinkTeaRate&&(s="平时不喝接待客人才喝");var c=i.returnPurposeType(n.forUse),d=i.returnTeaType(n.flavorHabit),l=i.returnIndustryType(n.industryOwned),p="/web/view/user/edit.html?id="+n.id;t+=e%2==0?"<tr>":'<tr class="even">';var f="'"+n.id+"'";t+="<td>"+a+"</td><td>"+n.realName+"</td><td>"+r+"</td><td>"+n.birthday+"</td><td>"+n.phone+"</td><td>"+n.wx+"</td><td>"+n.channel+"</td><td>"+n.address+"</td><td>"+o+"</td><td>"+s+"</td><td>"+c+"</td><td>"+d+"</td><td>"+l+'</td><td><a href="'+p+'" class="edit-row">编辑</a><a href="javascript:void(0)" class="del-row" onclick="userModule.delRowData('+f+')">删除</a></td></tr>'}),$("#userList").find("tbody").empty().append(t)},delRowData:function(e){var t=this;1==confirm("确定删除该行数据!")&&common.commAjax({type:"POST",url:"customerInfo/delete",data:{id:e},success:function(e){t.errorMessage("删除成功"),t.getUserlist(t.selectPageSize)},error:function(){t.errorMessage("删除失败")}})},getUserlist:function(e){var t=this;common.commAjax({type:"POST",url:"customerInfo/list",data:{pageNum:e,pageSize:10},success:function(e){if(e){var i=e.totalCount,n=e.totalPage,a=e.resultList,r=e.currentPage;t.createRowData(a),t.selectPageSize=r,$("#page").paging({pageNo:r,totalPage:n,totalSize:i,callback:function(e){e!=r&&userModule.getUserlist(e)}})}}})},returnPurposeType:function(e){if(!e)return"";var t=["自饮","送人","待客","收藏"],i=e.split(","),n="",a=i.length;return a>0&&$.each(i,function(e,i){n+=e==a-1?t[i]?t[i]:"":t[i]?t[i]+";":""}),n},returnTeaType:function(e){if(!e)return"";var t=e.split(","),i=["龙井","碧螺春","极白","都匀毛尖","信阳毛尖","竹叶青","白毫银针","白牡丹","生普","熟普","单丛","大红袍","铁观音","其它"],n="",a=t.length;return a>0&&$.each(t,function(e,t){n+=e==a-1?i[t]?i[t]:"":i[t]?i[t]+";":""}),n},returnIndustryType:function(e){if(!e)return"";var t=e.split(","),i=["金融","地产","科技","艺术","娱乐","传媒","公务员","企业主","其它"],n="",a=t.length;return a>0&&$.each(t,function(e,t){n+=e==a-1?i[t]?i[t]:"":i[t]?i[t]+";":""}),n},errorMessage:function(e){var t=$(".user-edit-page"),i=$('<div class="error-mes"><span>'+e+"</span></div>");t.append(i),i.fadeIn(function(){i.delay(1e3).fadeOut(function(){i.remove()})})}};